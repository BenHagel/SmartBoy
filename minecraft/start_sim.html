<html>
    <head>
        <meta charset="utf-8">
		<script src="PseudRand.js"></script>
        <script src="gpu-browser.min.js"></script>
        <!-- <script src="https://unpkg.com/gpu.js@2.15.2/dist/gpu-browser.min.js"></script> -->
		<script src="p5.min.js"></script>
        <script src="StdNn.js"></script>
        <script src="world_kernels.js"></script>
        <script src="SmartBoy_6_Nt.js"></script>

        <style>
            body{
                background-color: rgb( 83, 106, 109 );
            }
            #p5BoyCanvas{
                border: 5px solid black;
                max-width: 450px;
            }
            .hidden{
                transition: all 1s ease-in-out !important;
                opacity:0;
                max-height:0;
                max-width:0;
                display:none;
                padding:0 !important;
                margin:0 !important;
                border:none !important;
                overflow:hidden;
            }
            .disable-selectt {
                user-select: none; /* supported by Chrome and Opera */
                -webkit-user-select: none; /* Safari */
                -khtml-user-select: none; /* Konqueror HTML */
                -moz-user-select: none; /* Firefox */
                -ms-user-select: none; /* Internet Explorer/Edge */
                -webkit-user-drag: none;
            }
        </style>
    </head>

    <body>
        <!--TODO list-->
        <div class="hidden">
            Distributed computation.

            It's clear that whatever is the prime mover of intelligence inside the HUMAN brain
            comes from the interaction of similarly parametered compute units (NEURONS).

            The problem arrises from defining the interactions that require those parameters,
            And then finding the parameters through optimizing a fitness score in an environment.

            Because the whole puprose of this exercise would be to hone in on the values.

            Need to define: what the numbers define, and then what the numbers are.

            Things that must be possible in the domain of possibilities:
                Hebbian firing together and wiring together.
                Global hormone cycles included in each 

            Possible function points for a cell and when they're called:
                Receiving a signalx


            

            The current GLOBAL_SEED determines the SHARED_ENVIRONMENT_STATE based
            on the ENVIRONMENT_RULES.

            ENVIRONMENT_RULES


            Example:
            A 2d world of simple square, soft bounce collisions.
            global_seed determines how these particles can interact with each other.
            The environment_rules can 

            Question: what is the domain of things to solve?

            Solve a GPU-computable field of processing units

            There need to be a huge amount of them, and they need to be communicating with each other

            Super streamlined battle mechanics - RTS 
            nice physics based 3D on a 2D plane over world - classical battle stage engagenemnts
            Battle screen - your half, their half- in a fast generated world map:: place ur inventory where you want
            to stratetgiceally defend your army

            spring based baddies? still in 2d con

            place locatiopn and starting velocity!
             quick way to get into scenarios where physcis and emrgent phenomoone occur :
                : ships triyng to aviod each other + attack the enemy: ransack

        </div>


        <canvas id="canvForGPUToUse"></canvas>
        <div id="p5BoyCanvas">
            <p>Boys Brain:</p>
            <button onclick="addInputs()">Test Add Buttons</button>
        </div>

        <script>
            // Oracle control occurs here
            const randWorldSeed = Math.floor( Math.random() * 100300500 );
            console.log( 'Rand world seed:', randWorldSeed );
            var WORLD = new World( randWorldSeed, document.getElementById( 'canvForGPUToUse' ) );

            const randBoySeed = Math.floor( Math.random() * 300300500 );
            console.log( 'Rand boy seed:', randBoySeed );
            var BOY = new SmartBoy6( 16, randBoySeed, document.getElementById('p5BoyCanvas'));

            // Create the Smart boy agent, std nn,
            // Show the smart boy in 2d grid w p5js 
            //      + its various NT and hover over for even more detailed information
            // Show the 5-6 StdNN's values , weights of connectons for each, 
            
            // Create the bridge back and forther between smart boy and minecraft world.
            // Create the various elements in the World
            // Multiple iterations per SB step
            // Reward and  punishment functions - top down associate signals w other stuff.
            
            let avgs = [];
            let insize = 6;
            let nn = new StdNn( [insize, 1], 152398237 + Math.floor(23191233 * Math.random()) );
            for(let u = 0;u < 10;u++){
                let kks = new Array(insize);for(let o=0;o<kks.length;o++) kks[o] = Math.random();
                let out = nn.activate(kks)
                //avgs.push(out[0])
                console.log(out);
            }

            // let av = avgs.reduce((a, b) => a + b, 0) / avgs.length;
            // console.log('av', av);

            
            function addInputs(){
                BOY.activate([1,2,3,4,5,5,8]);
                BOY.step();
            }
            function tick() {
                for(let y = 0;y < 1;y++) WORLD.draw();   
                frame = requestAnimationFrame(tick);
            };
            //requestAnimationFrame(tick);
        </script>

        
        <!-- 
        <script>
            let CR = new CustomRandom("customseeed 85 :)_");
            const BIG_DIM = 512;

            function makegrid(cols,rows){
                var grid = new Array(cols);
                for(var i =0;i<cols;i++){
                    grid[i]=(new Array(rows)).fill(0).map(a=>Math.trunc(Math.random()));
                }
                return grid;
            }


            const gpu = new GPU();

            const multiplyMatrix = gpu.createKernel(function(a, b) {
                let sum = 0;
                for (let i = 0; i < 512; i++) {
                    sum += a[this.thread.y][i] * b[i][this.thread.x];
                }
                return sum;
            }).setOutput([BIG_DIM, BIG_DIM]);

            var inicio = gpu.createKernel(
                function() {
                    var val = Math.floor(Math.random()*2)
                    this.color(val,val,val);
                }, {useLegacyEncoder:true,output:[BIG_DIM, BIG_DIM], graphical:true}


            );

            let a = makegrid(BIG_DIM, BIG_DIM);
            let b = makegrid(BIG_DIM, BIG_DIM);
            const c = multiplyMatrix(a, b);

            console.log(c);
        </script>
        -->
    </body>
</html>